<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>home</title>
</head>
<body>
    

    <div>
        <h1 style="width:100%; text-align: center;"> SETTINGS </h1>
        <br>
        <p style="font-size:large; width:100%; text-align: center;">Install an app:</p>
        <br>
          <input class="elementbasic" id="AppUrlBox" placeholder="https://youtube.com" type=text>
          <button class="elementbasic" onclick="A2HS()">Install</button>
          <button class="elementbasic" onclick="confirm('This will remove all installed apps but still keep their data. To remove all app data clear MistOS app storage in android settings'); localStorage.setItem('MIST_APPS', null);">reset appindex (wipe disk)</button>

        <div>
    <p style="font-size:large; width:100%; text-align: center;">Change wallpaper (Gifs supported):</p>
      <input class="elementbasic" id="bkgurl" placeholder="Leave URL blank for default." type=text>
      <button class="elementbasic" onclick="setBKG()">set</button>
  </div>
    
    
    </div>


</body>

<script>
console.log('### S E T T I N G S   A P P');
//###startup
//Read apps index from localstorage!!

var DEJSONIFY = localStorage.getItem('MIST_APPS');
var apps = JSON.parse(DEJSONIFY);
if (apps == null) {
    console.log('App index is empty, so default apps are being installed. Welcome or Welcome back!');

    var apps = [];
apps[0]= "https://76836.github.io";
apps[1]= "https://google.com";
apps[2]= "https://github.com";
apps[3]= "https://youtube.com";

//write changes to localstorage
var JSONIFY = JSON.stringify(apps);
localStorage.setItem('MIST_APPS', JSONIFY);
console.log('MIST_APPS='+JSONIFY);
}
else {
    var DEJSONIFY = localStorage.getItem('MIST_APPS');
    var apps = JSON.parse(DEJSONIFY);
    console.log('App index read succesful:');
};
console.log(apps);



        if (BKGURL == "null" || BKGURL == "") {
BKGURL = "./Foreshadowing.jpg";
};

var ExCSS1 = document.createElement("style");
  ExCSS1.innerHTML =`		body  {
			background-image: url("`+BKGURL+`");
  			background-color: black;
			background-repeat: no-repeat;
			background-size: cover;
			overflow-x: hidden;
                        color:white;
			min-height:100vh;
			}`;

  var head = document.getElementsByName("head")[0];
  document.head.appendChild(ExCSS1);

  console.log('Background image loaded from persistent settings: '+BKGURL);
    
    
//###functions catalog
function A2HS()
        {
            //read text box contents
          var A2I=document.getElementById('AppUrlBox').value;
          console.log('A2HS:'+A2I);
            //retrieve apps index
          var DEJSONIFY = localStorage.getItem('MIST_APPS');
          var apps = JSON.parse(DEJSONIFY)
            //add subject to apps index
          apps.push(A2I);
            //save the updated index
          var JSONIFY = JSON.stringify(apps)
          localStorage.setItem('MIST_APPS', JSONIFY);
        };

 function setBKG()
        {
         var Url=document.getElementById('bkgurl').value;
           localStorage.setItem('selectedBKGURL', Url);
        };
    
/* notes for the future...
apps.splice(2, 1);
</script>

<style>
    .elementbasic {
        width:100%;
        height:10%;
        background-color:gray;
        border: 3px solid black;
    }
</style>
</html>
