<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>home</title>
</head>
<body>
    
    <div id="drawer">
<img onclick="window.location.href='./settings.html'" class="icon" src="https://icons.iconarchive.com/icons/dtafalonso/android-l/512/Settings-L-icon.png" onerror="this.onerror=null; this.src='./Foreshadowing.jpg'">
    </div>
</body>

<script>



//load the background
var BKGURL = localStorage.getItem('selectedBKGURL');
if (BKGURL == null || BKGURL == "") {
BKGURL = "./Foreshadowing.jpg";
};
var ExCSS1 = document.createElement("style");
ExCSS1.innerHTML =`		body  {
    background-image: url("`+BKGURL+`");
    background-color: black;
    background-repeat: no-repeat;
    background-size: cover;
    overflow: clip;
    color:white;
    min-height:100vh;
    background-position:center;
    }`;
var head = document.getElementsByName("head")[0];
document.head.appendChild(ExCSS1);

console.log('Background image loaded from persistent settings: '+BKGURL);

//### get the apps ~
var DEJSONIFY = localStorage.getItem('MIST_APPS');
var apps = JSON.parse(DEJSONIFY);
if (apps == null) {
    console.log('App index is empty, so default apps are being installed. Welcome or Welcome back!');

    var apps = [];
apps[0]= "https://76836.github.io";
apps[1]= "https://google.com";
apps[2]= "https://github.com";
apps[3]= "https://youtube.com";

//write changes to localstorage
var JSONIFY = JSON.stringify(apps);
localStorage.setItem('MIST_APPS', JSONIFY);
console.log('MIST_APPS='+JSONIFY);
}
else {
    var DEJSONIFY = localStorage.getItem('MIST_APPS');
    var apps = JSON.parse(DEJSONIFY);
    console.log('App index read succesful:');
};
console.log(apps);
//### got the apps ~


for (const app of apps) {
//create app icon for each app:

var element = document.createElement("img");
     element.appendChild(document.createTextNode(app));
     element.setAttribute('onclick', "window.location.href='"+app+"'");
     element.setAttribute('class', "icon");
     element.setAttribute('src', app+"/apple-touch-icon.png");
     element.setAttribute('ONERROR', "this.onerror=null; this.src='"+app+'/favicon.ico'+"'");
     var page = document.getElementById("drawer");
     page.appendChild(element);








console.log(' app icon for: \n'+app+'\n loaded');
};



</script>

<style>
.icon{
    width:15vw;
    height:15vw;
    border-radius: 7.5vw;
}
</style>
</html>