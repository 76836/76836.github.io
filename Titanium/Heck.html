
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />

    <title>Heck Voice Search</title>

  </head>

  <body>
    <h1>Heck voice serch, v1.0. Searches done using Microsoft Bing.</h1>
    <button style="width:100%;" onclick="recognition.start();">click to speak</button>

    <div>
      <p style="width:100%; text-align: center;" class="output"><em>dictated text will appear here</em></p>
    </div>


</body>


<script>
   const synth = window.speechSynthesis;

const inputForm = document.querySelector("form");
const inputTxt = document.querySelector(".txt");
const voiceSelect = document.querySelector("select");

const pitch = document.querySelector("#pitch");
const pitchValue = document.querySelector(".pitch-value");
const rate = document.querySelector("#rate");
const rateValue = document.querySelector(".rate-value");

let voices = [];

   function speak(WORDS) {
     if (synth.speaking) {
       console.error("speechSynthesis.speaking");
       return;
     }
   
     if (WORDS !== "") {
       const utterThis = new SpeechSynthesisUtterance(WORDS);
   
       utterThis.onend = function (event) {
         console.log("SpeechSynthesisUtterance.onend");
       };
   
       utterThis.onerror = function (event) {
         console.error("SpeechSynthesisUtterance.onerror");
       };
   
       const selectedOption = "Google US English (en-US)"
   
       for (let i = 0; i < voices.length; i++) {
         if (voices[i].name === selectedOption) {
           utterThis.voice = voices[i];
           break;
         }
       }
       utterThis.pitch = 1;
       utterThis.rate = 1;
       synth.speak(utterThis);
     }
   }

   </script>
 


<script>
function sleep(ms) {
  return new Promise(
    resolve => setTimeout(resolve, ms)
  );
}

var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
var recognition = new SpeechRecognition();
var textout = document.querySelector('.output');

recognition.onspeechend = async function() {
  await sleep(200);
  recognition.stop();
}

recognition.onresult = function(event) {
  var outcome = event.results[0][0].transcript;
  textout.textContent = outcome;
  speak("searching for"+outcome);
  window.location.href='Https://bing.com/search?q='+outcome
  var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  var recognition = new SpeechRecognition();
}
</script>
  

</html>
